# X = [
#     1 3 -2 7 0 -9 6 -1 6.25;
#     0 4 3 -1 8 6 -7 4 55.08;
#     0 0 7 4 2 -4 -8 2 -2.454;
#     0 0 0 -3 5 9 5 1 51.442;
#     0 0 0 0 2 -6 -4 8 0;
#     0 0 0 0 0 -5 0 3 -0.008;
#     0 0 0 0 0 0 -9 5 7.228;
#     0 0 0 0 0 0 0 6 24;
# ];

# retro_substitution(X);

# M = [
#     1 -5 3 9 -7 21 -7 -2 -10.79;
#     3 2 -5 8 3 -13 0 1 -2.14;
#     2 1 9 -6 -6 8 -3 3 -130.608;
#     4 -4 2 5 8 -6 2 -4 76.3;
#     -5 6 -4 4 9 -10 1 5 -11.1;
#     6 1 5 -2 15 4 -9 7 0.135;
#     0 9 1 1 -12 2 10 8 -3.108;
#     3 10 3 7 3 1 1 -3 632.5;
# ]

N = [
    1 -5 3 9 -7 21 -7 -2 -10.79;
    3 2 -5 8 3 -13 0 1 -2.14;
    2 1 9 -6 -6 8 -3 3 -130.608;
    4 -4 2 5 8 -6 2 -4 76.3;
    -5 6 -4 4 9 -10 1 5 -11.1;
    6 1 5 -2 15 4 -9 7 0.135;
    0 9 1 1 -12 2 10 8 -3.108;
    3 10 3 7 3 1 1 -3 632.5;
];

M = [
    1 -5 3 9 -7 21 -7 -2;
    3 2 -5 8 3 -13 0 1;
    2 1 9 -6 -6 8 -3 3;
    4 -4 2 5 8 -6 2 -4;
    -5 6 -4 4 9 -10 1 5;
    6 1 5 -2 15 4 -9 7;
    0 9 1 1 -12 2 10 8;
    3 10 3 7 3 1 1 -3;
];

b = [-10.79 -2.14 -130.608 76.3 -11.1 0.135 -3.108 632.5];

O = [
    8.7 3 9.3 11 16.4;
    24.5 -8.8 11.5 -45.1 -49.7;
    52.3 -84 -23.5 11.4 -80.8;
    21 -81 -13.2 21.5 -106.3;
];

N = gauss(N);
retro_substitution(N);

# iterative_residue(M, b');
[lin, col] = size(O);

iterative_residue(O(:, 1:col - 1), O(:, col));